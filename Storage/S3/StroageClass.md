# **S3 스토리지 클래스 사용**
S3의 각 객체에는 그와 연결된 스토리지 클래스가 있음. \
S3는 저장된 객체에 대해 다양한 스토리지 클래스를 제공. \
사용 사례 시나리오 및 성능 액세스 요구 사항에 따라 클래스를 선택.

## **자주 액세스하는 객체를 위한 스토리지 클래스**
성능에 민감한 사용 사례와 자주 액세스되는 데이터를 위해 사용.
### **S3 Standard**
기본 스토리지 클래스. 객체 업로드 시 스토리지 클래스를 지정하지 않으면 `S3 Standard` 스토리지 클래스를 할당.
### **Reduced Redundancy**
`S3 Standard` 보다 더 적은 중복성으로 저장될 수 있는 데이터 중에서도 중요하지 않고 재현 가능한 데이터를 목적으로 설계.


## **변경되는 또는 알 수 없는 액세스 패턴으로 데이터를 자동으로 최적화하는 스토리지 클래스**
### **S3 Intelligent-Tiering**
`S3 Intelligent-Tiering`은 성능 영향 또는 운영 오버헤드 없이 가장 비용 효과적인 액세스 계층으로 데이터를 자동으로 이동하여 스토리지 비용을 최적화하기 위한 스토리지 클래스. \
`S3 Intelligent-Tiering`는 검색 요금이 없음. \
약간의 월별 객체 모니터링 및 자동화 요금만 지불하면 `S3 Intelligent-Tiering`에서 액세스 패턴을 모니터링하고, 액세스하지 않은 객체를 저렴한 액세스 계층으로 자동으로 이동. \
대기 시간이 짧고 처리량이 높은 두 액세스 계층에서 스토리지 비용을 자동으로 절감할 수 있음. \
스토리지 클래스 내에서 자동 아카이브 기능을 활성화하도록 선택.\
`S3 Intelligent-Tiering`은 99.9%의 가용성과 99.9999999%의 내구성을 제공하도록 설계. \
`S3 Intelligent-Tiering`은 `Frequent Access`, `Infrequent Access`, `Archive Instant Access` 세 개의 액세스 계층에 객체를 자동으로 저장.
* **Frequent Access**
  * Intelligent-Tiering에 업로드 하거나 이전한 객체는 `Frequent Access` 계층으로 자동 저장.
* **Infrequent Access**
  * Intelligent-Tiering은 액세스 패턴을 모니터링한 후 30일 연속 액세스되지 않은 객체를 `Infrequent Access` 계층으로 이동하는 방식으로 작동.
* **Archive Instant Access**
	* Intelligent-Tiering은 연속 90일 동안 액세스 하지 않은 기존 객체를 자동으로 `Archive Insant Access`계층으로 자동으로 이동.
	* 아카이브 액세스 계층을 하나 또는 모두 활성화 하면 90일 연속으로 액세스되지 않은 객체를 자동으로 `Archive Access`계층으로 180일 연속으로 액세스되지 않은 객체는 다시 `Deep Archive Access`계층으로 이동.

## 자주 액세스하지 않는 객체를 위한 스토리지 클래스
`S3 Standard-IA` 및 `S3 One Zone-IA` 스토리지 클래스는 수명이 길고 자주 액세스 하지 않는 데이터용으로 설계. \
두 클래스는 밀리초 단위로 액세스 하는데 사용 가능. \
이들 객체에 대해 검색 비용을 부과하므로 이들 객체는 자주 액세스되지 않는 데이터에 가장 적합.
### **S3 Standard-IA**
S3는 객체 데이터를 지리적으로 분리된 여러 개의 가용 영역에 중복되게 저장.\
`One Zone-IA` 클래스보다 뛰어난 가용성 및 복원성 제공.
### **S3 One Zone-IA**
여러 가용영역에 저장되는 `Standard-IA`와 달리 하나의 가용 영역에만 저장하므로 요금이 저렴.\
지진 및 홍수와 같은 재해에 의한 가용 영역의 물리적 손실에 대해서는 복원성이 없음.

## 객체 아카이빙을 위한 스토리지 클래스
`S3 Glacier Instant Retrieval`, `S3 Glacier Flexible Retrieval` 및 `S3 Glacier Deep Archive` 클래스는 저비용 데이터 아카이브를 위해 설계.\
`S3 Standard`클래스와 동일한 내구성 및 복원성을 제공.
### **S3 Glacier Instant Retrieval**
거의 액세스 하지 않고 밀리초 단위로 검색해야 하는 데이터를 아카이브하는데 사용. \
`S3 Standard-IA`와 동일한 대기 시간 및 처리량 성능. \
`S3 Standard-IA`보다 저장 비용은 저렴 데이터 액세스 비용은 높음.

### **S3 Glacier Flexible Retrieval**
분 단위로 데이터의 일부를 검색해야 하는 아카이브에 사용.\
최소 저장 기간은 90일이며, 신속 검색을 사용하여 최소 1 ~ 5분 이내에 액세스 가능.\
검색 시간은 유연하며 최대 5 ~ 12시간 내에 무료 대량 검색을 요청 가능.\
90일 최소기간 이전에 삭제나 덮어쓰기, 다른 스토리지 클래스로 이전한 경우, 90일 요금이 부과.

### **S3 Glacier Deep Archive**
거의 액세스할 필요가 없는 데이터를 보관할 때 사용.\
최소 저장 기간은 180일이고 기본 검색 시간은 12 시간. \
180일 최소기간 이전에 삭제나 덮어쓰기, 다른 스토리지 클래스로 이전한 경우, 90일 요금이 부과.

### **아카이브된 객체 복원**
`S3 Glacier Flexible Retrieval`, `S3 Glacier Deep Archive`객체는 실시간 액세스를 사용할 수 없음.\
해당 클래스의 객체를 액세스 하려면 이들 객체를 먼저 복원해야함.

## Amazon S3 on Outposts에 대한 스토리지 클래스
`S3 on Outposts`를 사용하면 `AWS Outposts`에서 S3버킷을 생성하고 로컬 데이터 액세스, 데이터 처리 및 데이터 레지던시가 필요한 애플리케이션을 위해 온프레미스에서 객체를 저장하고 검색.\
`S3 on Outposts`는 `S3 Outposts`클래스 제공.\
`S3`와 같이 `AWS Outposts`에서도 동일한 `API` 및 기능을 사용.\
`S3 Outposts` 클래스는 `AWS Outposts`의 버킷에 저장된 객체에만 사용할 수 있음.\
`S3 버킷`과 함께 이 클래스를 사용하면 `InvalidStorageClass`오류 발생.
`S3 on Outposts`와 함께 다른 S3 스토리지 클래스를 사용하려고 하면 동일한 오류 발생. \
`S3 Outposts`클래스에 저장된 객체는 항상 S3 관리형 암호화 키(SSE-S3)와 함께 서버 측 암호화를 사용하여 암호화. \
고객 제공 암호화 키(SSE-C)와 함께 서버 측 암호화를 사용하여 객체를 암호화하도록 명시적으로 선택할 수도 있음.

## Amazon S3 스토리지 클래스 비교
|스토리 클래스 | 설계 목적 | 내구성(설계상) | 가용성(설계상) | 가용 영역 | 최소 스토리지 기간 | 최소 요금객체 크기|기타 고려 사항 |
|-----|---|----|----|-----|-------|--------|----|
|S3 Standard|자주 액세스 하는 데이터(한 달에 한번 이상), 밀리초 단위의 액세스|99.999999999%|99.99%|>=3|없음|없음|없음|
|S3 Standard-IA|밀리초 단위의 액세스로 한 달에 한번 이따금 액세스하는 수명이 긴 데이터|99.999999999%|99.9%|>=3|30일|128KB|GB당 검색 요금이 적용.|
|S3 Intelligent-Tiering|알 수 없거나 변경되거나 예측할 수 없는 액세스 패턴이 있는 데이터|99.999999999%|99.9%|>=3|없음|None|객체당 모니터링 및 자동화 비용이 적용. 검색 요금이 없음.|
|S3 One Zone-IA|재생성 가능하고 자주 액세스하지 않는 데이터(한 달에 한 번), 밀리초 단위의 액세스|99.999999999%|99.5%|1|30일|128KB|GB당 검색 요금이 적용. 가용 영역의 손실에 대한 복원력이 없음.|
|S3 Glacier Instant Retrieval|밀리초 단위의 액세스로 분기에 한 번 액세스하는 수명이 긴 아카이브 데이터|99.999999999%|99.9%|>=3|90일|128KB|GB당 검색 요금이 적용.|
|S3 Glacier Flexible Retrieval|몇 분에서 몇 시간의 검색 시간으로 1년에 한 번 액세스하는 수명이 긴 아카이브 데이터|99.999999999%|99.9%(객체 복원 후)|>=3|90일|40KB|GB당 검색 요금이 적용. 이 객체에 액세스하려면 먼저 보관된 객체를 복원.|
|S3 Glacier Deep Archive|몇 시간의 검색 시간으로 1년에 한 번 미만 액세스하는 수명이 긴 아카이브|99.999999999%|99.9%(객체 복원 후)|>=3|180일|40KB|GB당 검색 요금이 적용. 이 객체에 액세스하려면 먼저 보관된 객체를 복원.|
## 객체의 스토리지 클래스 설정
Amazon S3 콘솔, AWS SDK, AWS CLI를 사용하여 설정 가능. \
각각은 S3 API를 사용하여 S3에 요청 전송.
* 새 객체를 생성할 떄 그 객체의 스토리지 클래스를 지정할 수 있음. API를 사용하여 객체를 생성할 때 `x-amz-storage-class` 요청 헤더를 추가하여 스토리지 클래스 지정. 이 헤더를 추가하지 않으면 기본 클래스인 `Standard`를 사용
* 복사본을 이용해 S3에 이미 저장된 객체의 스토리지 클래스를 다른 스토리지 클래스로 변경. `S3 Glacier Flexible Retrieval`또는 `S3 Glacier Deep Archive` 스토리지 클래스에 저장된 객체를 복사하기 위해 API를 사용할 수 없음. `S3 One Zone-IA`에서 `S3 Glacier Instant Retrieval`로 전환할 수 없음. 버전 관리를 사용하는 버킷에는 특정 객체 버전의 스토리지 클래스를 변경할 수 없음.
  * `x-amz-metadta-directive`헤더를 COPY로 설정.
  * `x-amz-storage-class`를 사용하려는 스토리지 클래스로 설정.
* 특정 버킷에 S3 수명 주기 구성을 추가하면 S3가 객체의 스토리지 클래스를 변경하도록 유도할 수 있음.
* 복제 구성을 설정할 때 복제된 객체의 스토리지 클래스를 다른 스토리지 클래스로 설정. 다만 `Glacier Flexible Retrieval`, `Glacier Deep Archive` 스토리지 클래스에 저장된 객체는 복제 불가.